<div fxLayout="column" class="mat-card mat-elevation-z4 p-24">
  <div fxLayout.xs="column" fxLayout.gt.xs="row" fxLayoutAlign.gt-xs="space-between start">
    <!-- ================================================ -->
    <!-- ALUMNOS ================================================ -->
    <!-- ================================================ -->
    <div *ngIf="!cargandoAlumnos" fxLayout="column" class="w-100-p" fxFlex.xs="100" fxFlex.gt-xs="45">
      <div
        *ngIf="alumnos && alumnos.length > 0"
        [@animate]="{ value: '*', params: { delay: '50ms', scale: '0.2' } }"
        class="mt-20 p-0"
        fxLayoutAlign="space-between baseline"
        fxLayout="row"
      >
        <mat-form-field appearance="outline" color="accent" fxFlex.xs="100" fxFlex.gt-xs="45">
          <mat-label>Búsqueda Rápida</mat-label>
          <input matInput users (keyup)="filtroRapido($event.target.value)" [disabled]="dataSource.data.length == 0" />
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>
        <div fxLayout="row" fxLayoutAlign="end center">
          <button mat-raised-button color="accent">Agregar Asistencia</button>
        </div>
      </div>
      <table
        mat-table
        matSort
        #sort="matSort"
        [dataSource]="dataSource"
        class="borde-tabla mat-elevation-z4 w-100-p"
        [class.mt-20]="!alumnos || alumnos.length < 1"
      >
        <!-- 'nombreCompleto', 'seguimientoEtap' -->
        <ng-container matColumnDef="nombreCompleto">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</th>
          <td mat-cell *matCellDef="let row">
            <span
              [ngClass]="{
                row_seleccionada: row.selected
              }"
            >
              {{ row.nombreCompleto }}
            </span>
          </td>
        </ng-container>
        <ng-container matColumnDef="seguimientoEtap">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>ETAP</th>
          <td mat-cell *matCellDef="let row">
            <!-- <h4
              [ngClass]="{
                row_seleccionada: row.selected
              }"
            >
              {{ row.seguimientoEtap ? 'SI' : 'NO' }}
            </h4> -->
            <span *ngIf="!row.seguimientoEtap" class="nav-link-badge text-center no_tiene_etap"> NO </span>
            <span *ngIf="row.seguimientoEtap" class="nav-link-badge text-center tiene_etap">SI</span>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnas"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: columnas"
          [class.selected]="row.selected"
          [ngClass]="{
            hovered: row.hovered,
            highlighted: row.highlighted
          }"
          (mouseover)="row.hovered = true"
          (mouseout)="row.hovered = false"
          (click)="buscarAsistenciasPorAlumno(row)"
        ></tr>
      </table>
      <app-empty-data *ngIf="!alumnos || alumnos.length < 1"></app-empty-data>
      <!-- Paginado -------------------------------------------------- -->
      <mat-paginator class="border-paginador paginator mat-elevation-z2" #paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 25, 100]">
      </mat-paginator>
    </div>
    <!-- ================================================ -->
    <!-- ASISTENCIAS VACIAS ================================================ -->
    <!-- ================================================ -->

    <!-- ================================================ -->
    <!-- ASISTENCIAS ================================================ -->
    <!-- ================================================ -->

    <div fxLayout="column" class="w-100-p" fxFlex.xs="100" fxFlex.gt-xs="45" [class.mt-100]="asistencias && asistencias.length < 1">
      <!-- *ngIf="asistencias && asistencias.length > 0" -->

      <div
        [@animate]="{ value: '*', params: { delay: '50ms', scale: '0.2' } }"
        fxLayout="column"
        class="w-100-p"
        style="background: #353a48; color: white; padding: 12px"
      >
        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px">
          <strong>Total de Clases</strong><span>{{ totalClases }}</span>
        </div>
        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px">
          <strong>Total de Asistencias</strong><span>{{ totalPresentes.valor }} ({{ totalPresentes.porcentaje }}%)</span>
        </div>
        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px">
          <strong>Total de Ausentes</strong><span>{{ totalAusentes.valor }} ({{ totalAusentes.porcentaje }}%)</span>
        </div>
        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" style="color: orange">
          <strong>Clases NO REGISTRADAS</strong><span>{{ totalNoRegistradas.valor }} ({{ totalNoRegistradas.porcentaje }}%)</span>
        </div>
        <!-- <div><strong>Cantidad de Ausencias</strong><span>{{totalAusencias}}</span></div> -->
      </div>
      <table mat-table matSort #sortAsistencia="matSort" [dataSource]="dataSourceAsistencia" class="borde-tabla mat-elevation-z4 w-100-p">
        <!-- 'fecha', 'presente', 'llegoTarde' -->
        <ng-container matColumnDef="fecha">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha</th>
          <td mat-cell *matCellDef="let row">
            {{ row.fecha | date: 'dd/MM/yyyy' }}
          </td>
        </ng-container>
        <ng-container matColumnDef="presente">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Presente</th>
          <td mat-cell *matCellDef="let row">
            <!-- <h4>{{ row.presente ? 'SI' : 'NO' }}</h4> -->
            <span *ngIf="!row.presente" class="nav-link-badge text-center ausente"> NO </span>
            <span *ngIf="row.presente" class="nav-link-badge text-center presente">SI</span>
          </td>
        </ng-container>
        <ng-container matColumnDef="llegoTarde">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Tarde</th>
          <td mat-cell *matCellDef="let row">
            <!-- <h4>{{ row.llegoTarde ? 'SI' : 'NO' }}</h4> -->
            <span *ngIf="!row.llegoTarde" class="nav-link-badge text-center no-tarde"> NO </span>
            <span *ngIf="row.llegoTarde" class="nav-link-badge text-center tarde">SI</span>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="columnasAsistencia"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: columnasAsistencia"
          [class.selected]="row.selected"
          [ngClass]="{
            hovered: row.hovered,
            highlighted: row.highlighted
          }"
          (mouseover)="row.hovered = true"
          (mouseout)="row.hovered = false"
        ></tr>
      </table>
      <div
        fxLayout="row"
        fxLayoutGap="10px"
        fxLayoutAlign="center center"
        *ngIf="cargandoAsistencias && (!asistencias || asistencias.length < 1)"
        class="mat-card p-24 text-center"
      >
        <mat-spinner matSuffix class="ml-10" diameter="20"></mat-spinner>
        <p>Cargando...</p>
      </div>
      <app-empty-data
        [texto]="'No hay registros cargados'"
        *ngIf="!cargandoAsistencias && (!asistencias || asistencias.length < 1)"
      ></app-empty-data>
      <!-- Paginado -------------------------------------------------- -->
      <mat-paginator
        class="border-paginador paginator mat-elevation-z2"
        #paginatorAsistencia
        [pageSize]="5"
        [pageSizeOptions]="[5, 10, 25, 100]"
      >
      </mat-paginator>
    </div>
  </div>
</div>
